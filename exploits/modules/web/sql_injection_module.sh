#!/bin/bash
# Automated SQL Injection Module

execute_sql_injection() {
    local target="$1"
    local payload_file="$2"
    
    while IFS='|' read -r payload_type payload description risk_level; do
        if [[ "$payload_type" != "#"* && -n "$payload" ]]; then
            test_sql_payload "$target" "$payload" "$description" "$risk_level"
        fi
    done < "$payload_file"
}

test_sql_payload() {
    local target="$1"
    local payload="$2"
    local description="$3"
    local risk_level="$4"
    
    local encoded_payload=$(echo "$payload" | sed 's/ /%20/g' | sed "s/'/%27/g")
    local test_url="$target?id=$encoded_payload"
    
    local response=$(curl -s --max-time 10 "$test_url" 2>/dev/null)
    
    if echo "$response" | grep -qi "mysql\|sql syntax\|oracle\|postgresql"; then
        echo "SQL injection found: $description"
        echo "Payload: $payload"
        echo "Risk: $risk_level"
        return 0
    fi
    
    return 1
}
